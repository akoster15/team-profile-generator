{"version":3,"sources":["RenderRegistry.ts"],"names":["internalTextRenderers","br","BRRenderer","wbr","WBRRenderer","RenderRegistry","constructor","customRenderers","elementModels","getInternalTextRenderer","tagName","getRendererConfigForTNode","tnode","Custom","getCustomRendererForTNode","Default","getDefaultRendererForTNode","internalRenderers","renderer","__DEV__","elementModel","console","warn","matchContentModel","contentModel","displayName"],"mappings":";;;;;;;AAGA;;AACA;;AACA;;AAMA;;;;;;AAMA,MAAMA,qBAAkE,GAAG;AACzEC,EAAAA,EAAE,EAAEC,mBADqE;AAEzEC,EAAAA,GAAG,EAAEC;AAFoE,CAA3E;;AAUe,MAAMC,cAAN,CAAqB;AAIlCC,EAAAA,WAAW,CACTC,eAAwC,GAAG,EADlC,EAETC,aAFS,EAGT;AAAA,6CAN0D,EAM1D;;AAAA;;AACA,SAAKD,eAAL,GAAuBA,eAAvB;AACA,SAAKC,aAAL,GAAqBA,aAArB;AACD;;AAEDC,EAAAA,uBAAuB,CAACC,OAAD,EAAyB;AAC9C,QAAI,2BAAaV,qBAAb,EAAoCU,OAApC,CAAJ,EAAkD;AAChD,aAAOV,qBAAqB,CAACU,OAAD,CAA5B;AACD;;AACD,WAAO,IAAP;AACD;;AAEDC,EAAAA,yBAAyB,CAAkBC,KAAlB,EAA+C;AACtE,WAAO;AACLC,MAAAA,MAAM,EAAE,KAAKC,yBAAL,CAA+BF,KAA/B,CADH;AAELG,MAAAA,OAAO,EAAE,KAAKC,0BAAL,CAAgCJ,KAAhC;AAFJ,KAAP;AAID;;AAEOI,EAAAA,0BAA0B,CAChCJ,KADgC,EAEJ;AAC5B,QAAIA,KAAK,CAACF,OAAN,IAAkBO,0BAAtB,EAAyC;AACvC;AACA,aAAOA,2BAAkBL,KAAK,CAACF,OAAxB,CAAP;AACD;;AACD,WAAO,IAAP;AACD;;AAEOI,EAAAA,yBAAyB,CAC/BF,KAD+B,EAEe;AAC9C,QAAIA,KAAK,CAACF,OAAN,IAAkB,KAAKH,eAA3B,EAA4C;AAC1C,YAAMW,QAAQ,GAAG,KAAKX,eAAL,CAAqBK,KAAK,CAACF,OAA3B,CAAjB;AACA;;AACA,UAAIS,OAAJ,EAAa;AACX;AACA,cAAMC,YAAY,GAAG,KAAKZ,aAAL,CAAmBI,KAAK,CAACF,OAAzB,CAArB;;AACA,YAAI,CAACU,YAAL,EAAmB;AACjBC,UAAAA,OAAO,CAACC,IAAR,CACG,kCAAiCV,KAAK,CAACF,OAAS,kIADnD;AAGD,SAJD,MAIO,IAAI,CAACE,KAAK,CAACW,iBAAN,CAAwBH,YAAY,CAACI,YAArC,CAAL,EAAyD;AAC9DH,UAAAA,OAAO,CAACC,IAAR,CACG,iCAAgCV,KAAK,CAACF,OAAQ,cAAaE,KAAK,CAACa,WAAY,2DAA0DL,YAAxI,aAAwIA,YAAxI,uBAAwIA,YAAY,CAAEI,YAAa,gCAA+BZ,KAAK,CAACa,WAAY,IADtN;AAGD;AACF;;AACD,aAAOP,QAAP;AACD;;AACD,WAAO,IAAP;AACD;;AA1DiC","sourcesContent":["import { TNode } from '@native-html/transient-render-engine';\nimport { ComponentType } from 'react';\nimport { CustomRendererProps } from '..';\nimport lookupRecord from '../helpers/lookupRecord';\nimport BRRenderer from '../renderers/BRRenderer';\nimport WBRRenderer from '../renderers/WBRRenderer';\nimport {\n  CustomRenderer,\n  HTMLElementModelRecord,\n  InternalRenderer\n} from '../shared-types';\nimport internalRenderers from './internalRenderers';\nimport {\n  CustomTagRendererRecord,\n  InternalTextContentRenderer\n} from './render-types';\n\nconst internalTextRenderers: Record<string, InternalTextContentRenderer> = {\n  br: BRRenderer,\n  wbr: WBRRenderer\n};\n\nexport interface RendererConfig<T extends TNode> {\n  Default: InternalRenderer<T> | null;\n  Custom: CustomRenderer<T> | null;\n}\n\nexport default class RenderRegistry {\n  private readonly customRenderers: CustomTagRendererRecord = {};\n  private readonly elementModels: HTMLElementModelRecord;\n\n  constructor(\n    customRenderers: CustomTagRendererRecord = {},\n    elementModels: HTMLElementModelRecord\n  ) {\n    this.customRenderers = customRenderers;\n    this.elementModels = elementModels;\n  }\n\n  getInternalTextRenderer(tagName: string | null) {\n    if (lookupRecord(internalTextRenderers, tagName)) {\n      return internalTextRenderers[tagName];\n    }\n    return null;\n  }\n\n  getRendererConfigForTNode<T extends TNode>(tnode: T): RendererConfig<T> {\n    return {\n      Custom: this.getCustomRendererForTNode(tnode),\n      Default: this.getDefaultRendererForTNode(tnode)\n    };\n  }\n\n  private getDefaultRendererForTNode<T extends TNode>(\n    tnode: T\n  ): InternalRenderer<T> | null {\n    if (tnode.tagName! in internalRenderers) {\n      //@ts-ignore\n      return internalRenderers[tnode.tagName!];\n    }\n    return null;\n  }\n\n  private getCustomRendererForTNode<T extends TNode>(\n    tnode: T\n  ): ComponentType<CustomRendererProps<T>> | null {\n    if (tnode.tagName! in this.customRenderers) {\n      const renderer = this.customRenderers[tnode.tagName!];\n      /* istanbul ignore next */\n      if (__DEV__) {\n        // In DEV, check for discrepancies.\n        const elementModel = this.elementModels[tnode.tagName!];\n        if (!elementModel) {\n          console.warn(\n            `You are attempting to render a ${tnode.tagName!} tag but you didn't provide an HTMLElementModel. Make sure you register a model for this tag in \"customHTMLElementModels\" prop. `\n          );\n        } else if (!tnode.matchContentModel(elementModel.contentModel)) {\n          console.warn(\n            `You are attempting to render \"${tnode.tagName}\" of type \"${tnode.displayName}\", but the registered renderer is of content model type ${elementModel?.contentModel} which is incompatible with \"${tnode.displayName}\".`\n          );\n        }\n      }\n      return renderer as any;\n    }\n    return null;\n  }\n}\n"]}